{"version":3,"sources":["./src/app/receiver/receiver.component.ts","./src/app/receiver/receiver.component.scss","./node_modules/file-saver/dist/FileSaver.min.js","./src/app/receiver/receiver.selectors.ts","./src/app/receiver/receiver.component.html","./src/app/services/signaling-receiver.service.ts","./src/app/receiver/receiver.state.ts","./src/app/receiver/receiver.module.ts"],"names":[],"mappings":"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","file":"receiver-receiver-module.js","sourcesContent":["import {\n  AfterViewInit,\n  ChangeDetectionStrategy,\n  Component,\n  ViewChild\n} from '@angular/core';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { ActivatedRoute } from '@angular/router';\nimport { Select, Store } from '@ngxs/store';\nimport { TuiStepperComponent } from '@taiga-ui/kit';\nimport {\n  NgxFileDropEntry\n} from 'ngx-file-drop';\nimport { StateReset } from 'ngxs-reset-plugin';\nimport { Observable } from 'rxjs';\nimport { concatMap } from 'rxjs/operators';\nimport { v1 as uuidv1 } from 'uuid';\nimport { IFileSending } from '../app.model';\nimport { CommonService } from '../services/common.service';\nimport {\n  AccessChanelAction, SetCurrentStepAction,\n  StartLeechingAction\n} from './receiver.action';\nimport { ReceiverSelectors } from './receiver.selectors';\nimport { ReceiverState } from './receiver.state';\n\n@Component({\n  selector: 'receiver',\n  templateUrl: 'receiver.component.html',\n  styleUrls: ['receiver.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ReceiverComponent implements AfterViewInit {\n  public files: NgxFileDropEntry[] = [];\n\n  @Select(ReceiverSelectors.chanelId) chanelId$: Observable<string>;\n  @Select(ReceiverSelectors.accessKey) accessKey$: Observable<string>;\n  @Select(ReceiverSelectors.localFiles) files$: Observable<IFileSending[]>;\n  @Select(ReceiverSelectors.steps) steps$: Observable<any>;\n  @Select(ReceiverSelectors.currentStep) currentStep$: Observable<any>;\n\n  leechForm: FormGroup;\n  @ViewChild('stepper') stepper: TuiStepperComponent;\n\n  constructor(\n    private store: Store,\n    private commonService: CommonService,\n    private activeRoute: ActivatedRoute\n  ) {\n    this.store.dispatch(new StateReset(ReceiverState));\n\n    this.leechForm = new FormGroup({\n      channelId: new FormControl(''),\n      accessKey: new FormControl(''),\n    });\n\n    const queryParams = this.activeRoute.snapshot.queryParams;\n    if (Object.keys(queryParams).length > 0) {\n      this.leechForm.patchValue(queryParams);\n      if (Object.keys(queryParams).length == 2) this.startLeech();\n    }\n  }\n\n  ngAfterViewInit(): void {}\n\n  startLeech() {\n    const self = this;\n    const channelId: string = this.leechForm.get('channelId').value;\n    const accessKey: string = this.leechForm.get('accessKey').value;\n    if (channelId.trim() === '' || accessKey.trim() === '') {\n      this.commonService.showDialog('Please enter id and key!!').subscribe();\n      self.stepper.activeItemIndex = -1;\n    } else {\n      this.leechForm.disable();\n      this.store.dispatch(new AccessChanelAction(channelId, accessKey));\n      this.store\n        .dispatch(new SetCurrentStepAction(1))\n        .pipe(\n          concatMap((val) => {\n            return this.store.dispatch(new StartLeechingAction());\n          })\n        )\n        .subscribe();\n    }\n  }\n\n  fileMapping(files: FileList | File[]) {\n    let mapList: File[] = [];\n    if (files instanceof FileList) mapList = Array.from(files);\n    else mapList = files;\n    const filesMap: IFileSending[] = mapList.map((file) => {\n      return {\n        fileId: uuidv1(),\n        fileName: file.name,\n        sendProcess: 0,\n        status: 0,\n        fileData: file,\n      };\n    });\n    return filesMap;\n  }\n\n  click(item: HTMLElement) {\n    item.nodeValue = null;\n    item.click();\n  }\n  onClose(item) {}\n\n  showDonate(content) {\n    this.commonService.showDialogWithTemplate(content);\n  }\n}\n","export default \"::ng-deep .ngx-file-drop__content {\\n  position: absolute;\\n  height: unset !important;\\n}\\n\\n::ng-deep .ngx-file-drop__drop-zone {\\n  border: unset !important;\\n  width: 356px;\\n  height: 358px !important;\\n}\\n\\n::ng-deep tui-stepper {\\n  position: relative;\\n  top: 480px;\\n  height: 60px;\\n}\\n\\n::ng-deep tui-stepper button * {\\n  margin-left: auto !important;\\n  margin-right: auto !important;\\n}\\n\\n::ng-deep tui-stepper button:nth-child(1) {\\n  margin-right: auto;\\n  margin-left: 2.5rem;\\n}\\n\\n::ng-deep tui-stepper button:nth-child(2) {\\n  margin-left: auto;\\n  margin-right: auto;\\n}\\n\\n::ng-deep tui-stepper button:nth-child(3) {\\n  margin-left: auto;\\n  margin-right: 1.5rem;\\n}\\n\\n.e2_22 {\\n  background-image: url('rectangle_2.png');\\n  background-repeat: no-repeat;\\n  background-size: cover;\\n}\\n\\n.donate {\\n  width: 100%;\\n  height: 100%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uXFwuLlxcLi5cXHJlY2VpdmVyLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBO0VBQ0Usa0JBQUE7RUFDQSx3QkFBQTtBQURGOztBQUlBO0VBQ0Usd0JBQUE7RUFDQSxZQUFBO0VBQ0Esd0JBQUE7QUFERjs7QUFJQTtFQUNFLGtCQUFBO0VBQ0EsVUFBQTtFQUNBLFlBQUE7QUFERjs7QUFFRTtFQUNFLDRCQUFBO0VBQ0EsNkJBQUE7QUFBSjs7QUFFRTtFQUNFLGtCQUFBO0VBQ0EsbUJBQUE7QUFBSjs7QUFFRTtFQUNFLGlCQUFBO0VBQ0Esa0JBQUE7QUFBSjs7QUFFRTtFQUNFLGlCQUFBO0VBQ0Esb0JBQUE7QUFBSjs7QUFnQkE7RUFDRSx3Q0FBQTtFQUNBLDRCQUFBO0VBQ0Esc0JBQUE7QUFiRjs7QUFnQkE7RUFDRSxXQUFBO0VBQ0EsWUFBQTtBQWJGIiwiZmlsZSI6InJlY2VpdmVyLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gY29tcG9uZW50IGNzcyBnb2VzIGhlcmVcblxuOjpuZy1kZWVwIC5uZ3gtZmlsZS1kcm9wX19jb250ZW50IHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBoZWlnaHQ6IHVuc2V0ICFpbXBvcnRhbnQ7XG59XG5cbjo6bmctZGVlcCAubmd4LWZpbGUtZHJvcF9fZHJvcC16b25lIHtcbiAgYm9yZGVyOiB1bnNldCAhaW1wb3J0YW50O1xuICB3aWR0aDogMzU2cHg7XG4gIGhlaWdodDogMzU4cHggIWltcG9ydGFudDtcbn1cblxuOjpuZy1kZWVwIHR1aS1zdGVwcGVye1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIHRvcDogNDgwcHg7XG4gIGhlaWdodDogNjBweDtcbiAgYnV0dG9uICoge1xuICAgIG1hcmdpbi1sZWZ0OiBhdXRvICFpbXBvcnRhbnQ7XG4gICAgbWFyZ2luLXJpZ2h0OiBhdXRvICFpbXBvcnRhbnQ7XG4gIH1cbiAgYnV0dG9uOm50aC1jaGlsZCgxKXtcbiAgICBtYXJnaW4tcmlnaHQ6IGF1dG87XG4gICAgbWFyZ2luLWxlZnQ6IDIuNXJlbVxuICB9XG4gIGJ1dHRvbjpudGgtY2hpbGQoMil7XG4gICAgbWFyZ2luLWxlZnQ6IGF1dG87XG4gICAgbWFyZ2luLXJpZ2h0OiBhdXRvO1xuICB9XG4gIGJ1dHRvbjpudGgtY2hpbGQoMyl7XG4gICAgbWFyZ2luLWxlZnQ6IGF1dG87XG4gICAgbWFyZ2luLXJpZ2h0OiAxLjVyZW1cbiAgfVxufVxuXG4vLyBbZGF0YS10dWktaG9zdC1zaXplPSdsJ11bX25naG9zdC1tYmEtYzE0M10ge1xuXG4vLyAgIGhlaWdodDogdmFyKC0tdHVpLWhlaWdodC1sKTtcblxuLy8gICBtaW4taGVpZ2h0OiB2YXIoLS10dWktaGVpZ2h0LWwpO1xuXG4vLyAgIG1heC1oZWlnaHQ6IHZhcigtLXR1aS1oZWlnaHQtbCk7XG5cbi8vICAgZm9udC1zaXplOiAxNXB4O1xuXG4vLyB9XG5cbi5lMl8yMntcbiAgYmFja2dyb3VuZC1pbWFnZTogdXJsKC4uLy4uL2Fzc2V0cy9pbWFnZXMvcmVjdGFuZ2xlXzIucG5nKTtcbiAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDtcbiAgYmFja2dyb3VuZC1zaXplOiBjb3Zlcjtcbn1cblxuLmRvbmF0ZXtcbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcbn0iXX0= */\";","(function(a,b){if(\"function\"==typeof define&&define.amd)define([],b);else if(\"undefined\"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){\"use strict\";function b(a,b){return\"undefined\"==typeof b?b={autoBom:!1}:\"object\"!=typeof b&&(console.warn(\"Deprecated: Expected third argument to be a object\"),b={autoBom:!b}),b.autoBom&&/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(a.type)?new Blob([\"\\uFEFF\",a],{type:a.type}):a}function c(a,b,c){var d=new XMLHttpRequest;d.open(\"GET\",a),d.responseType=\"blob\",d.onload=function(){g(d.response,b,c)},d.onerror=function(){console.error(\"could not download file\")},d.send()}function d(a){var b=new XMLHttpRequest;b.open(\"HEAD\",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent(\"click\"))}catch(c){var b=document.createEvent(\"MouseEvents\");b.initMouseEvent(\"click\",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f=\"object\"==typeof window&&window.window===window?window:\"object\"==typeof self&&self.self===self?self:\"object\"==typeof global&&global.global===global?global:void 0,a=f.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=f.saveAs||(\"object\"!=typeof window||window!==f?function(){}:\"download\"in HTMLAnchorElement.prototype&&!a?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement(\"a\");g=g||b.name||\"download\",j.download=g,j.rel=\"noopener\",\"string\"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target=\"_blank\")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:\"msSaveOrOpenBlob\"in navigator?function(f,g,h){if(g=g||f.name||\"download\",\"string\"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement(\"a\");i.href=f,i.target=\"_blank\",setTimeout(function(){e(i)})}}:function(b,d,e,g){if(g=g||open(\"\",\"_blank\"),g&&(g.document.title=g.document.body.innerText=\"downloading...\"),\"string\"==typeof b)return c(b,d,e);var h=\"application/octet-stream\"===b.type,i=/constructor/i.test(f.HTMLElement)||f.safari,j=/CriOS\\/[\\d]+/.test(navigator.userAgent);if((j||h&&i||a)&&\"undefined\"!=typeof FileReader){var k=new FileReader;k.onloadend=function(){var a=k.result;a=j?a:a.replace(/^data:[^;]*;/,\"data:attachment/file;\"),g?g.location.href=a:location=a,g=null},k.readAsDataURL(b)}else{var l=f.URL||f.webkitURL,m=l.createObjectURL(b);g?g.location=m:location.href=m,g=null,setTimeout(function(){l.revokeObjectURL(m)},4E4)}});f.saveAs=g.saveAs=g,\"undefined\"!=typeof module&&(module.exports=g)});\n\n//# sourceMappingURL=FileSaver.min.js.map","import { Selector } from '@ngxs/store';\r\nimport { ReceiverStateModel } from './receiver.state';\r\nimport { ReceiverState } from './receiver.state';\r\n\r\nexport class ReceiverSelectors {\r\n  @Selector([ReceiverState])\r\n  static localId(state: ReceiverStateModel) {\r\n    return state.localId;\r\n  }\r\n\r\n  @Selector([ReceiverState])\r\n  static steps(state: ReceiverStateModel) {\r\n    return state.steps;\r\n  }\r\n\r\n  @Selector([ReceiverState])\r\n  static currentStep(state: ReceiverStateModel) {\r\n    return state.currentStep;\r\n  }\r\n\r\n  @Selector([ReceiverState])\r\n  static chanelId(state: ReceiverStateModel) {\r\n    return state.channelId;\r\n  }\r\n\r\n  @Selector([ReceiverState])\r\n  static accessKey(state: ReceiverStateModel) {\r\n    return state.accessKey;\r\n  }\r\n\r\n  @Selector([ReceiverState])\r\n  static localFiles(state: ReceiverStateModel) {\r\n    return state.localFiles;\r\n  }\r\n}\r\n","export default \"<!--component html goes here -->\\n<!--component html goes here -->\\n<div class=\\\"e1_3\\\"></div>\\n<div class=\\\"e2_21\\\">\\n  <div class=\\\"relative cursor-pointer\\\">\\n    <div class=\\\"e1_8 pointer-events-none\\\"></div>\\n    <div class=\\\"e2_22 pointer-events-none\\\"></div>\\n    <span class=\\\"e2_23 pointer-events-none\\\">If you like my project</span>\\n    <div class=\\\"e2_25\\\">\\n      <button\\n        tuiButton\\n        type=\\\"button\\\"\\n        class=\\\"ei2_25_1_15\\\"\\n        (click)=\\\"showDonate(template)\\\"\\n      >\\n        Donate\\n      </button>\\n    </div>\\n    <span class=\\\"e2_28\\\"> you can </span>\\n    <span class=\\\"e1_7 pointer-events-none\\\">YOUR FILE ARE SECURED</span>\\n  </div>\\n</div>\\n<ng-container *ngIf=\\\"files$ | async as files\\\">\\n  <div *ngIf=\\\"!files || files.length === 0\\\" div class=\\\"e1_20\\\">\\n    <div class=\\\"e1_10\\\"></div>\\n    <div class=\\\"e1_21\\\"></div>\\n    <div class=\\\"e1_24\\\">\\n      <span class=\\\"e1_22 ellipsis\\\">PLEASE ENTER ID AND KEY...</span>\\n      <div class=\\\"e1_23\\\"></div>\\n    </div>\\n    <button\\n      tuiIconButton\\n      type=\\\"button\\\"\\n      class=\\\"e104_1\\\"\\n      icon=\\\"tuiIconCloseLarge\\\"\\n    ></button>\\n  </div>\\n  <div *ngIf=\\\"files && files[0]\\\" div class=\\\"e1_20\\\">\\n    <div class=\\\"e1_10\\\"></div>\\n    <div class=\\\"e1_21\\\"></div>\\n    <div class=\\\"e1_24\\\">\\n      <span class=\\\"e1_22 ellipsis\\\">{{ files[0].fileName }}</span>\\n      <div class=\\\"e1_23\\\"></div>\\n    </div>\\n    <button\\n      tuiIconButton\\n      type=\\\"button\\\"\\n      class=\\\"e104_1\\\"\\n      icon=\\\"tuiIconCloseLarge\\\"\\n      (click)=\\\"onClose($event)\\\"\\n    ></button>\\n  </div>\\n  <div *ngIf=\\\"files && files[1]\\\" class=\\\"e1_33\\\">\\n    <div class=\\\"ei1_33_1_10\\\"></div>\\n    <div class=\\\"ei1_33_1_21\\\"></div>\\n    <div class=\\\"ei1_33_1_24\\\">\\n      <span class=\\\"ei1_33_1_22 ellipsis\\\">{{ files[1].fileName }}</span>\\n      <div class=\\\"ei1_33_1_23\\\"></div>\\n    </div>\\n    <button\\n      tuiIconButton\\n      type=\\\"button\\\"\\n      class=\\\"ei1_33_104_1\\\"\\n      icon=\\\"tuiIconCloseLarge\\\"\\n      (click)=\\\"onClose($event)\\\"\\n    ></button>\\n  </div>\\n  <div *ngIf=\\\"files && files[2]\\\" class=\\\"e1_42\\\">\\n    <div class=\\\"ei1_42_1_10\\\"></div>\\n    <div class=\\\"ei1_42_1_21\\\"></div>\\n    <div class=\\\"ei1_42_1_24\\\">\\n      <span class=\\\"ei1_42_1_22 ellipsis\\\">{{ files[2].fileName }}</span>\\n      <div class=\\\"ei1_42_1_23\\\"></div>\\n    </div>\\n    <button\\n      tuiIconButton\\n      type=\\\"button\\\"\\n      class=\\\"ei1_42_104_1\\\"\\n      icon=\\\"tuiIconCloseLarge\\\"\\n      (click)=\\\"onClose($event)\\\"\\n    ></button>\\n  </div>\\n</ng-container>\\n<span class=\\\"e1_52 pointer-events-none\\\">ID:</span>\\n<form class=\\\"b-form\\\" [formGroup]=\\\"leechForm\\\">\\n  <tui-input class=\\\"e1_54\\\" tuiTextfieldSize=\\\"s\\\" formControlName=\\\"accessKey\\\">\\n    Ask your friend about shared key\\n  </tui-input>\\n  <tui-input class=\\\"e103_20\\\" tuiTextfieldSize=\\\"s\\\" formControlName=\\\"channelId\\\">\\n    Ask your friend about shared id\\n  </tui-input>\\n</form>\\n<span class=\\\"e1_53 pointer-events-none\\\">KEY:</span>\\n\\n<tui-stepper\\n  #stepper\\n  [activeItemIndex]=\\\"currentStep$ | async\\\"\\n  *ngIf=\\\"steps$ | async as steps\\\"\\n>\\n  <!-- Suppid html, Iknow, but i got problem when set stepper inside a div -->\\n  <button\\n    #step0Enable\\n    class=\\\"block\\\"\\n    tuiStep\\n    [state]=\\\"steps[0].state\\\"\\n    (click)=\\\"startLeech()\\\"\\n    [disabled]=\\\"steps[0].disable\\\"\\n    icon=\\\"tuiIconTimeLarge\\\"\\n  >\\n    <div class=\\\"w-16\\\">{{ steps[0].name }}</div>\\n  </button>\\n  <button\\n    #step1Enable\\n    class=\\\"block\\\"\\n    tuiStep\\n    [state]=\\\"steps[1].state\\\"\\n    [disabled]=\\\"steps[1].disable\\\"\\n    icon=\\\"tuiIconTimeLarge\\\"\\n  >\\n    <div class=\\\"w-16\\\">{{ steps[1].name }}</div>\\n  </button>\\n  <button\\n    #step2Enable\\n    class=\\\"block\\\"\\n    tuiStep\\n    [state]=\\\"steps[2].state\\\"\\n    [disabled]=\\\"steps[2].disable\\\"\\n    icon=\\\"tuiIconTimeLarge\\\"\\n  >\\n    <div class=\\\"w-16\\\">{{ steps[2].name }}</div>\\n  </button>\\n</tui-stepper>\\n\\n<ng-template #template polymorpheus let-observer>\\n  <img src=\\\"../../assets/images/IMG_1148.JPG\\\" class=\\\"donate\\\">\\n</ng-template>\\n\";","import { DOCUMENT } from '@angular/common';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { AfterViewInit, Inject, Injectable, ViewChild } from '@angular/core';\r\nimport { RxStompService } from '@stomp/ng2-stompjs';\r\nimport { Message } from '@stomp/stompjs';\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\nimport { environment } from 'src/environments/environment';\r\nimport {\r\n  IFileInformation,\r\n  IGetNextPartResDTO,\r\n  IInitChanelReqDTO,\r\n  IPreFlightModel,\r\n  ISignalingMessage,\r\n  SignalingMessage,\r\n} from '../app.model';\r\nimport { SignalingService } from './signaling.service';\r\nimport * as FileSaver from 'file-saver';\r\nimport { Store } from '@ngxs/store';\r\nimport {\r\n  AddNewFileInfoAction,\r\n  SetCurrentStepAction,\r\n} from '../receiver/receiver.action';\r\n\r\n@Injectable({\r\n  providedIn: 'any',\r\n})\r\nexport class SignalingReceiver extends SignalingService {\r\n  // downloadAnchor;\r\n\r\n  crrFileInfo: IFileInformation;\r\n\r\n  constructor(\r\n    protected readonly httpClient: HttpClient,\r\n    protected readonly rxStompService: RxStompService,\r\n    protected store: Store\r\n  ) {\r\n    super(httpClient, rxStompService);\r\n    this.createConnection();\r\n    console.log('SignalingReceiver init');\r\n  }\r\n\r\n  createConnection() {\r\n    this.localConnection = new RTCPeerConnection(this.configuration);\r\n\r\n    this.localConnection.addEventListener('icecandidate', async (event) => {\r\n      console.log('Local ICE candidate: ', event.candidate);\r\n      if (event.candidate) {\r\n        this.sharingICECandidateToOtherParty(event.candidate);\r\n      }\r\n    });\r\n\r\n    this.localConnection.addEventListener(\r\n      'datachannel',\r\n      this.receiveChannelCallback.bind(this)\r\n    );\r\n  }\r\n\r\n  async messageHandler(message: ISignalingMessage) {\r\n    if (!message) return;\r\n    await super.messageHandler(message);\r\n    switch (message.content) {\r\n      case 'offer': {\r\n        await this.localConnection.setRemoteDescription(message.data);\r\n        await this.sendAnswerToSender();\r\n        this.crrFileInfo = message.info;\r\n        this.store.dispatch(new AddNewFileInfoAction(this.crrFileInfo));\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  async sendAnswerToSender() {\r\n    const self = this;\r\n    try {\r\n      const answer = await this.localConnection.createAnswer();\r\n      await this.localConnection.setLocalDescription(answer);\r\n\r\n      this.rxStompService.publish({\r\n        destination: `/topic/${this.remoteId}`,\r\n        body: JSON.stringify(\r\n          new SignalingMessage(this.localId, this.remoteId, 'answer', answer)\r\n        ),\r\n      });\r\n    } catch (e) {\r\n      // Stupid way, but it's worked\r\n      setTimeout(async () => {\r\n        await self.sendAnswerToSender();\r\n      }, 1000);\r\n    }\r\n  }\r\n\r\n  getNextPartInformation(chanelId: string): Observable<IGetNextPartResDTO> {\r\n    return this.httpClient.get(\r\n      [\r\n        environment.API_HOST,\r\n        environment.EV_PATH,\r\n        environment.CHANEL_PATH,\r\n        chanelId,\r\n        'partner',\r\n      ].join('/'),\r\n      { params: { peerId: this.localId, fileId: '' } }\r\n    );\r\n  }\r\n\r\n  preflightToSender(fileId: string, partId: Number = 0) {\r\n    let message: ISignalingMessage = {\r\n      from: this.localId,\r\n      to: this.remoteId,\r\n      content: 'preflight',\r\n      data: <IPreFlightModel>{ fileId, partId },\r\n    };\r\n    this.rxStompService.publish({\r\n      destination: `/topic/${this.remoteId}`,\r\n      body: JSON.stringify(message),\r\n    });\r\n  }\r\n\r\n  receiveChannelCallback(event) {\r\n    console.log('Receive Channel Callback');\r\n    this.dataChannel = event.channel;\r\n    this.dataChannel.binaryType = 'arraybuffer';\r\n    this.dataChannel.onmessage = this.onReceiveMessageCallback.bind(this);\r\n    this.dataChannel.onopen = this.onReceiveChannelStateChange.bind(this);\r\n    this.dataChannel.onclose = this.onReceiveChannelStateChange.bind(this);\r\n\r\n    this.receivedSize = 0;\r\n    this.bitrateMax = 0;\r\n    // this.downloadAnchor = <any>this.document.getElementById(\"download\");\r\n    // this.downloadAnchor.textContent = '';\r\n    // this.downloadAnchor.removeAttribute('download');\r\n    // if (this.downloadAnchor.href) {\r\n    //   URL.revokeObjectURL(this.downloadAnchor.href);\r\n    //   this.downloadAnchor.removeAttribute('href');\r\n    // }\r\n  }\r\n\r\n  onReceiveMessageCallback(event) {\r\n    console.log(`Received Message ${event.data.byteLength}`);\r\n    this.receiveBuffer.push(event.data);\r\n    this.receivedSize += event.data.byteLength;\r\n    // receiveProgress.value = this.receivedSize;\r\n\r\n    // we are assuming that our signaling protocol told\r\n    // about the expected file size (and name, hash, etc).\r\n    // const file = fileInput.files[0];\r\n    const file = this.crrFileInfo;\r\n\r\n    if (this.receivedSize === file.fileSize) {\r\n      const received = new Blob(this.receiveBuffer);\r\n      this.receiveBuffer = [];\r\n\r\n      // this.downloadAnchor.href = URL.createObjectURL(received);\r\n      // this.downloadAnchor.download = file.fileName;\r\n      // this.downloadAnchor.textContent = `Click to download '${file.fileName}' (${file.fileSize} bytes)`;\r\n      // this.downloadAnchor.style.display = 'block';\r\n      FileSaver.saveAs(received, file.fileName);\r\n\r\n      const blob = new Blob([received], { type: 'blob' });\r\n      // const url= window.URL.createObjectURL(blob);\r\n      // window.open(url);\r\n\r\n      const bitrate = Math.round(\r\n        (this.receivedSize * 8) / (new Date().getTime() - this.timestampStart)\r\n      );\r\n      // this.bitrateDiv.innerHTML = `<strong>Average Bitrate:</strong> ${bitrate} kbits/sec (max: ${this.bitrateMax} kbits/sec)`;\r\n      console.log(\r\n        `<strong>Average Bitrate:</strong> ${bitrate} kbits/sec (max: ${this.bitrateMax} kbits/sec)`\r\n      );\r\n\r\n      if (this.statsInterval) {\r\n        clearInterval(this.statsInterval);\r\n        this.statsInterval = null;\r\n      }\r\n\r\n      this.closeDataChannels();\r\n    }\r\n  }\r\n\r\n  async onReceiveChannelStateChange() {\r\n    if (this.dataChannel) {\r\n      const readyState = this.dataChannel.readyState;\r\n      console.log(`Receive channel state is: ${readyState}`);\r\n      if (readyState === 'open') {\r\n        this.timestampStart = new Date().getTime();\r\n        this.timestampPrev = this.timestampStart;\r\n        this.statsInterval = setInterval(this.displayStats, 500);\r\n        await this.displayStats();\r\n      }\r\n    }\r\n  }\r\n\r\n  closeDataChannels() {\r\n    if (this.dataChannel) {\r\n      this.dataChannel.close();\r\n      console.log(`Closed data channel with label: ${this.dataChannel.label}`);\r\n      this.dataChannel = null;\r\n      this.store.dispatch(new SetCurrentStepAction(2));\r\n    }\r\n\r\n    this.localConnection.close();\r\n    this.localConnection = null;\r\n  }\r\n}\r\n","import {\r\n  ApplicationRef,\r\n  ChangeDetectorRef,\r\n  Inject,\r\n  Injectable,\r\n  Injector,\r\n} from '@angular/core';\r\nimport { Action, Selector, State, StateContext } from '@ngxs/store';\r\nimport produce from 'immer';\r\nimport { IInitChanelReqDTO, _TInstanceState } from '../app.model';\r\nimport {\r\n  AddNewFileInfoAction,\r\n  AccessChanelAction,\r\n  SetCurrentStepAction,\r\n  StartLeechingAction,\r\n} from './receiver.action';\r\nimport { v1 as uuidv1 } from 'uuid';\r\nimport { SignalingReceiver } from '../services/signaling-receiver.service';\r\nimport { HttpErrorResponse } from '@angular/common/http';\r\nimport { CommonService } from '../services/common.service';\r\n\r\ninterface _ReceiverStateModel extends Partial<_TInstanceState> {\r\n  accessKey: string;\r\n  steps: {\r\n    state: 'normal' | 'pass' | 'error';\r\n    disable: boolean;\r\n    name: string;\r\n  }[];\r\n  currentStep: Number;\r\n}\r\n\r\nexport interface ReceiverStateModel extends Partial<_ReceiverStateModel> {}\r\n\r\n@State<ReceiverStateModel>({\r\n  name: 'receiverState',\r\n  defaults: {\r\n    channelId: '',\r\n    accessKey: '',\r\n    localId: '',\r\n    peerId: '',\r\n    localFiles: [],\r\n    peerFiles: [],\r\n    steps: [\r\n      { state: 'normal', disable: false, name: 'Ready' },\r\n      { state: 'normal', disable: true, name: 'Connecting' },\r\n      { state: 'normal', disable: true, name: 'Leeching' },\r\n    ],\r\n    currentStep: -1,\r\n  },\r\n})\r\n@Injectable()\r\nexport class ReceiverState {\r\n  signalingService: SignalingReceiver;\r\n  constructor(\r\n    private injector: Injector,\r\n    private commonService: CommonService\r\n  ) {}\r\n\r\n  ngxsOnInit(ctx?: StateContext<ReceiverStateModel>) {\r\n    let localId = localStorage.getItem('localId');\r\n    if (!localId) {\r\n      localId = 'p' + uuidv1().replace(/\\-/g, '_');\r\n      localStorage.setItem('localId', localId);\r\n    }\r\n    ctx.setState(\r\n      produce((draft: ReceiverStateModel) => {\r\n        draft.localId = localId;\r\n      })\r\n    );\r\n  }\r\n\r\n  @Action(AccessChanelAction)\r\n  accessChanel(\r\n    ctx: StateContext<ReceiverStateModel>,\r\n    action: AccessChanelAction\r\n  ) {\r\n    ctx.setState(\r\n      produce((draft) => {\r\n        draft.channelId = action.chanelId;\r\n        draft.accessKey = action.accessKey;\r\n      })\r\n    );\r\n  }\r\n\r\n  @Action(SetCurrentStepAction)\r\n  setCurrentSate(\r\n    ctx: StateContext<ReceiverStateModel>,\r\n    action: SetCurrentStepAction\r\n  ) {\r\n    const state = ctx.getState();\r\n\r\n    this.signalingService = this.injector.get(SignalingReceiver);\r\n    this.signalingService.setLocalIdAndStartListenMessage(state.localId);\r\n\r\n    console.log('SetCurrentStepAction', action);\r\n    ctx.setState(\r\n      produce((draft) => {\r\n        const tep = draft.currentStep;\r\n        draft.currentStep = action.step;\r\n        draft.steps = draft.steps.map((step, idx) => {\r\n          if (idx < action.step) {\r\n            step.state = 'pass';\r\n            step.disable = true;\r\n          }\r\n          if (idx > action.step) {\r\n            step.state = 'normal';\r\n            step.disable = true;\r\n          }\r\n          return step;\r\n        });\r\n      })\r\n    );\r\n    // Get next peer\r\n  }\r\n\r\n  @Action(AddNewFileInfoAction)\r\n  addFiles(ctx: StateContext<ReceiverStateModel>, action: AddNewFileInfoAction) {\r\n    console.log('Action', action);\r\n    ctx.setState(\r\n      produce((draft) => {\r\n        if(draft.localFiles.findIndex(file => file.fileId === action.file.fileId) === -1) {\r\n          draft.localFiles.push({...action.file});\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  @Action(StartLeechingAction)\r\n  startLeeching(ctx: StateContext<ReceiverStateModel>) {\r\n    const self = this;\r\n    const state = ctx.getState();\r\n    console.log('startLeeching');\r\n    this.setCurrentSate(ctx, new SetCurrentStepAction(1))\r\n\r\n    // Get next peer\r\n    // Step 1\r\n    this.signalingService.getNextPartInformation(state.channelId).subscribe(\r\n      (res) => {\r\n        if (res) {\r\n          const senderId = res.peerId;\r\n          ctx.setState(\r\n            produce((draft) => {\r\n              draft.peerId = senderId;\r\n            })\r\n          );\r\n          self.signalingService.setRemoteId(senderId);\r\n          // Step 2\r\n          self.signalingService.preflightToSender(res.fileId, res.partId);\r\n          this.setCurrentSate(ctx, new SetCurrentStepAction(2))\r\n        }\r\n      },\r\n      (err: HttpErrorResponse) => {\r\n        console.log(err);\r\n      }\r\n    );\r\n  }\r\n}\r\n","// Angular Imports\nimport { AsyncPipe, CommonModule } from '@angular/common';\nimport { APP_INITIALIZER, ChangeDetectorRef, NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { RouterModule } from '@angular/router';\nimport { NgxsModule } from '@ngxs/store';\nimport {\n  TuiInputModule,\n  TuiStepperComponent,\n  TuiStepperModule,\n} from '@taiga-ui/kit';\nimport { TuiButtonModule, TuiSvgModule } from '@taiga-ui/core';\n\n// This Module's Components\nimport { ReceiverComponent } from './receiver.component';\nimport { ReceiverState } from './receiver.state';\nimport { NgxFileDropModule } from 'ngx-file-drop';\n\nimport { TuiTextfieldControllerModule } from '@taiga-ui/core';\nimport { SignalingReceiver } from '../services/signaling-receiver.service';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    RouterModule.forChild([\n      {\n        path: '',\n        component: ReceiverComponent,\n      },\n    ]),\n    NgxsModule.forFeature([ReceiverState]),\n    TuiButtonModule,\n    TuiStepperModule,\n    NgxFileDropModule,\n    FormsModule,\n    ReactiveFormsModule,\n    TuiInputModule,\n    TuiTextfieldControllerModule,\n  ],\n  providers: [AsyncPipe, TuiStepperComponent, SignalingReceiver],\n  declarations: [ReceiverComponent],\n  exports: [ReceiverComponent],\n})\nexport class ReceiverModule {}\n"],"sourceRoot":"webpack:///"}